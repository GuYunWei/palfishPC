<html>

<head>
    <meta charset="UTF-8">
    <title>伴鱼口语网页版</title>
    <meta name="keywords" content="伴鱼，伴鱼口语，Palfish，英语口语，英语培训机构，在线口语，口语，雅思托福，练听力，背单词，51talk，VIPABC，ABC360，面包英语，英语流利说，真人外教，外教1对1">
    <meta name="description" content="“伴鱼口语”是一款好玩又有效的英语口语学习应用，让你忍不住开口说英语，帮你真正摆脱“哑巴英语”。国内首款真人外教语音视频交流应用，打破传统语言学习方式，让英语交流变得更自然，更有趣。口语爱好者的社区，帮你提升英语综合能力，长期雄霸教育类榜单，千万英语爱好者必备英语学习神器。">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/chat.css">
    <style>
        .chat_item .avatar .icon {
            position: absolute;
            top: -6px;
            right: -6px;
            color: #FFF;
            font-style: normal;
            font-size: 12px;
            text-align: center;
            background: url(images/sprite.png) 0 -1780px;
            width: 22px;
            height: 19px;
            vertical-align: middle;
            display: inline-block;
        }
    </style>
</head>

<body>
    <div class="main">
        <div class="main_inner">
            <div class="panel">
                <!--BEGIN header-->
                <div class="header">
                    <div class="avatar">
                        <img class="img" src="images/132.jpg">
                    </div>
                    <div class="info">
                        <h3 class="nickname">
                            <span class="display_name">史博先</span>
                            <a class="opt" href="javascript:;" ><i class="palfish_add"></i></a>
                        </h3>
                    </div>
                </div>
                <!--END header-->
                <div class="search_bar" id="search_bar">
                    <i class="palfish_search"></i>
                    <input class="frm_search" type="text" placeholder="搜索">
                </div>
                <div id="navView"></div>
                <div class="nav_view">
                    <div class="scroll-wrapper chat_list">
                        <div class="scroll-content">
                            <p class="ico_loading hide"><img src="images/ico_loading.gif" alt="">正在获取最近的聊天...</p>
                            <div id="userItem">
                                <div>
                                    <div class="chat_item">
                                        <div class="ext">
                                            <p class="attr">12:10</p>
                                            <p class="attr">
                                                <i class="palfish_no-remind"></i>
                                            </p>
                                        </div>
                                        <div class="avatar">
                                            <img class="img" src="images/132.jpg" alt="">
                                        </div>
                                        <div class="info">
                                            <h3 class="nickname"><span class="nickname_text">文件传输助手</span></h3>
                                            <p class="msg">
                                                <span>test</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="chat_item">
                                        <div class="ext">
                                            <p class="attr">12:10</p>
                                            <p class="attr">
                                                <i class="palfish_no-remind"></i>
                                            </p>
                                        </div>
                                        <div class="avatar">
                                            <img class="img" src="images/132.jpg" alt="">
                                        </div>
                                        <div class="info">
                                            <h3 class="nickname"><span class="nickname_text">real__隔壁老顾</span></h3>
                                            <p class="msg">
                                                <span>test</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div ui-view="contentView" style="height:100%;">
                <div id="chatArea" class="box chat">
                    <!--BEGIN HD-->
                    <div class="box_hd">
                        <div id="chatRoomMembersWrap"></div>
                        <div class="title_wrap">
                            <div class="title poi">
                                <a class="title_name">Benny</a>
                                <i class="palfish_down_icon hide"></i>
                            </div>
                        </div>

                    </div>
                    <!--END HD-->
                    <!--BEGIN BD-->
                    <div class="scroll-wrapper box_bd">
                        <div class="box_bd scroll-content">
<!--
                            <div> 
                                <div class="top-placeholder" style="height: 0px;"></div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message me">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_primary right">
                                                        <div class="bubble_cont">
                                                            <div class="plain">
                                                                <pre class="js_message_plain">移民POS你牛移民1</pre>
                                                                <img class="ico_loading" src="images/ico_loading.gif" alt="">
                                                                <i class="ico_fail palfish_message_fail hide" title="重新发送"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_default left">
                                                        <div class="bubble_cont">
                                                            <div class="plain">
                                                                <pre class="js_message_plain">移民POS你牛移民1</pre>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_default left">
                                                        <div class="bubble_cont">
                                                            <div class="picture">
                                                                <img class="msg-img" src="images/thumbnail.jpg" data-src="images/Penguins.jpg">
                                                                <i class="arrow"></i>
                                                                <p class="loading hide">
                                                                    <img src="images/ico_loading.gif" alt="">
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_default left">
                                                        <div class="bubble_cont">
                                                            <div class="picture">
                                                                <img class="msg-img" src="images/Desert.jpg" data-src="images/Desert.jpg">
                                                                <i class="arrow"></i>
                                                                <p class="loading hide">
                                                                    <img src="images/ico_loading.gif" alt="">
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_default left">
                                                        <div class="bubble_cont">
                                                            <div class="picture">
                                                                <img class="msg-img" src="images/Hydrangeas.jpg" data-src="images/Hydrangeas.jpg">
                                                                <i class="arrow"></i>
                                                                <p class="loading hide">
                                                                    <img src="images/ico_loading.gif" alt="">
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_default left">
                                                        <div class="bubble_cont">
                                                            <div class="picture">
                                                                <img class="msg-img" src="images/Jellyfish.jpg" data-src="images/Jellyfish.jpg">
                                                                <i class="arrow"></i>
                                                                <p class="loading hide">
                                                                    <img src="images/ico_loading.gif" alt="">
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_default left">
                                                        <div class="bubble_cont">
                                                            <div class="voice"style="width: 53.097px;">
                                                                <i class="palfish_voice_gray"></i>
                                                                <span class="duration">2''<i class="palfish_noread hide"></i></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="clearfix">
                                        <div style="overflow: hidden;">
                                            <div class="message me">
                                                <p class="message_system"><span class="content">10:43</span></p>
                                                <img class="avatar" src="images/132.jpg" title="real__隔壁老顾">
                                                <div class="content">
                                                    <div class="bubble js_message_bubble bubble_primary right">
                                                    <div class="bubble_cont">
                                                            <div class="voice" style="width: 51.06px;">
                                                                <i class="palfish_voice_green"></i>
                                                                <span class="duration">2''<i class="palfish_noread hide"></i></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="bottom-placeholder" style="height: 0px;"></div>
                            </div>
-->
<!--                            <div id="prerender"></div>-->
                            <div class="message_empty hide">
                                <i class="palfish_nomes_icon"></i>
                                <p class="">暂时没有新消息</p>
                                <p class="">未选择聊天</p>
                            </div>
                        </div>
                    </div>
                    <!--END BD-->
                    <!--BEGIN FT-->
                    <div class="box_ft">
                        <div class="toolbar" id="tool_bar">
                            <!--<a class="palfish_face" href="javascript:;" title="表情"></a>-->
                            <!--<a class="palfish_screencut" href="javascript:;" title="截屏"></a>-->
                            <a id="webuploader" class="webuploader-container" href="javascript:;" title="图片">
                                <div id="fileList" class="webuploader-pick"></div>
                                <div id="filePicker">
                                    <input type="file" name="file" class="webuploader-element-invisible" multiple="multiple">
                                    <label></label>
                                </div>
                            </a>
                        </div>
                        <div id="contentArea" class="content">
                            <!--                            <pre id="editArea" class="flex edit_area" contenteditable="true"></pre>-->
                            <textarea id="editArea" class="flex edit_area" style="background:transparent;"></textarea>
                            <span class="caret_pos_helper" id="caretPosHelper"></span>
                        </div>

                        <div class="action">
                            <span class="desc">按下Ctrl+Enter换行</span>
                            <a class="btn btn_send" href="javascript:;">发送</a>
                        </div>
                    </div>
                    <!--END FT-->
                </div>
            </div>
        </div>
        <p class="copyright">
            <span>京ICP备15009744号-1</span>
            <span>联系我们：<i>bd@ipalfish.com</i></span>
        </p>
    </div>
    <div id="imgPreview" class="hide">
        <div class="mask preview_mask"></div>
        <div class="img_preview_container" id="preview_container">
            <div id="imgContainer">
                <a href="javascript:" class="img_preview_close" title="关闭"><i class="palfish_close-window"></i></a>
            </div>
            <div class="img_opr_container" id="img_opr_container">
                <ul class="img_opr_list">
                    <li class="img_opr_item">
                        <a id="prev" href="javascript:" title="查看上一个">
                            <i class="palfish_left palfish_left_disable"></i>&nbsp;
                        </a>
                    </li>
                    <li class="img_opr_item">
                        <a id="download" href="javascript:" title="下载图片">
                            <i class="palfish_download"></i>&nbsp;
                        </a>
                        <iframe src="" name="show"  style="width:0;height:0"></iframe>
                    </li>
                    <li id="toLeft" class="img_opr_item">
                        <a href="javascript:" title="旋转图片">
                            <i class="palfish_turn"></i>&nbsp;
                        </a>
                    </li>
                    <li class="img_opr_item">
                        <a id="next" href="javascript:" title="查看下一个">
                            <i class="palfish_right palfish_right_disable"></i>&nbsp;
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div style="position:absolute;top:0;left:0;width:0;height:0;">
        <audio id="voiceMsgPlayer" class="voicePlayer" preload="metadata" src="" style="width: 0px; height: 0px;"></audio>
        <!--<audio id="msgNoticePlayer" class="voicePlayer" preload="metadata" src="https://wx.qq.com/zh_CN/htmledition/v2/sound/msg.mp3" style="width: 0px; height: 0px;"></audio>-->
    </div>
</body>
<script src="js/jquery-2.1.1.min.js"></script>
<script src="js/jquery.slimscroll.min.js"></script>
<script src="js/ImageTrans.js"></script>
<script src="js/index.js"></script>
<script>
    var h_m = 107105, token = "85fb70418b53730020dd30714c866fb3";
    $(function () {
        $('.scroll-content').slimScroll({
            height: '100%',
            start: 'bottom'
        });
        $('#editArea').slimScroll({
            height: '6em'
        });
        
        var worker = new Worker('js/worker.js');
        worker.postMessage([h_m, token]);
        worker.addEventListener('message', function (ev) {
            var data = JSON.parse(ev.data);
            if(typeof data == 'number'){
                var smsgid = sessionStorage.getItem("smsgid");
                if(!smsgid || ev.data > smsgid){
                    sessionStorage.setItem("smsgid", ev.data);
                }
            }else{
                updateUserList(data);
            }
        })
    })
    
    function updateUserList(user){
        var uid = user.ctype == 1 ? (user.uid != h_m ? user.uid : user.touid) : user.sdialogid;
        var item = $("#userItem .chat_item[uid=" + uid + "]"), html = '';
        if(item.length > 0) return false;
        html += '' +
            '<div class="chat_item" ctype=1 uid="' + uid + '" time="' + user.ct + '">' +
            '<div class="ext">' +
            '<p class="attr"></p>' +
            '<p class="attr">' +
            '<i class=""></i>' +
            '</p>' +
            '</div>' +
            '<div class="avatar">' +
            '<img class="img" src="' + user.avatar + '" alt="">' +
            '<i class="icon">4</i>' +
            '</div>' +
            '<div class="info">' +
            '<h3 class="nickname"><span class="nickname_text">' + user.name + '</span></h3>' +
            '<p class="msg">' +
            '<span></span>' +
            '</p>' +
            '</div>' +
            '</div>';
        $('#userItem').append(html);
        $(".box_bd").append("<div class='chatItems' uid='" + uid + "'></div>")
    }
</script>

</html>